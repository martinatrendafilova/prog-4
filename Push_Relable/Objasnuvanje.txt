Глобални променливи

capacity[u][v] — колку проток може да оди од јазол u кон јазол v.

flow[u][v] — колку проток веќе е испратено.

height[u] — “висината” на јазолот. Помага да знаеме каде може да испратиме проток.

excess[u] — колку проток е вишок во јазолот.

seen[u] — кој сосед следен ќе го пробаме за испраќање на проток.

excess_vertices — ред со јазли кои имаат вишок и треба да се обработат.

Push

Пренесува проток од u до v.

Може само ако u е повисок од v (height[u] > height[v]).

Ја намалува вишок количината кај u и ја зголемува кај v.

Ако v сега има прв вишок, го ставаме во редот за обработка.

Relabel

Ако не можеме да испратиме проток кон ниту еден сосед, ја зголемуваме висината на јазолот за да може понатаму да испратиме.

Тоа значи “зголеми се за еден чекор” над најнискиот сосед што има капацитет.

Discharge

Додека јазолот има вишок, пробуваме да испратиме кон сите соседи (seen[u] ни кажува каде сме застанале).

Ако не може, го релабелуваме и почнуваме одново.

Целта е да го исчистиме вишокот на проток од тој јазол.

Max Flow

Почнуваме со голем вишок кај изворот и ја поставуваме неговата висина на бројот на јазли (height[s] = n).

Испумпуваме проток од изворот кон сите соседи (preflow).

Потоа додека има јазли со вишок (редот excess_vertices), ги обработуваме со discharge.

На крај, сумата од сите протоци што влегле во сливот (t) е максималниот проток.

